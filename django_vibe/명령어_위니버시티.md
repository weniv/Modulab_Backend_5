# 위니버시티 - ICT 영상 강의 플랫폼

## 1. URL 설계
```
'/' : 홈 페이지
'/accounts/signup/': 회원가입 페이지
'/accounts/login/': 로그인 페이지
'/accounts/logout/': 로그아웃
'/courses/': 강의 목록 페이지
'/courses/<int:course_id>/': 강의 상세 페이지
'/courses/<int:course_id>/enroll/': 수강 신청
'/dashboard/': 대시보드 메인
'/dashboard/my-courses/': 내 수강 강의 목록
'/streaming/<int:course_id>/lessons/': 레슨 목록
'/streaming/<int:course_id>/lessons/<int:lesson_id>/': 레슨 상세 (영상 재생)
```

## 2. Model 설계
```python
from django.contrib.auth.models import AbstractUser

class User(AbstractUser):
    profile_image = models.ImageField(upload_to='profiles/', blank=True)
    bio = models.TextField(blank=True)
    is_instructor = models.BooleanField(default=False)

class Category(models.Model):
    name = models.CharField(max_length=100, unique=True)
    slug = models.SlugField(unique=True)

class Course(models.Model):
    title = models.CharField(max_length=200)
    description = models.TextField()
    thumbnail = models.ImageField(upload_to='thumbnails/', blank=True)
    instructor = models.ForeignKey(User, on_delete=models.CASCADE)
    category = models.ForeignKey(Category, on_delete=models.SET_NULL, null=True)
    created_at = models.DateTimeField(auto_now_add=True)

class Enrollment(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    course = models.ForeignKey(Course, on_delete=models.CASCADE)
    enrolled_at = models.DateTimeField(auto_now_add=True)
    class Meta:
        unique_together = ['user', 'course']

class Lesson(models.Model):
    course = models.ForeignKey(Course, on_delete=models.CASCADE)
    title = models.CharField(max_length=200)
    video_url = models.URLField()
    order = models.PositiveIntegerField()
    class Meta:
        unique_together = ['course', 'order']
```

## 3. 초기 세팅 명령어

### 3.1 Windows
```bash
python -m venv venv
venv\Scripts\activate
pip install django pillow
django-admin startproject config .
```

### 3.2 macOS / Linux
```bash
python3 -m venv venv
source venv/bin/activate
pip install django pillow
django-admin startproject config .
```

### 3.3 공통
```python
# config/settings.py

ALLOWED_HOSTS = ['*']

#################################
# terminal commands
# python manage.py migrate는 초급자만 하고 중고급자들은 처음에 migrate 하지 않습니다. 기본 user 모델을 건드리면 충돌이 나기 때문입니다.

python manage.py migrate
python manage.py runserver
```

## 4. 앱 생성 및 등록

```python
# terminal commands
python manage.py startapp accounts
python manage.py startapp courses
python manage.py startapp dashboard
python manage.py startapp streaming

#################################
# config/settings.py

INSTALLED_APPS = [
    ...
    'accounts',
    'courses',
    'dashboard',
    'streaming',
]

AUTH_USER_MODEL = 'accounts.User'

#################################
# config/urls.py

from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('courses.urls')),
    path('accounts/', include('accounts.urls')),
    path('dashboard/', include('dashboard.urls')),
    path('streaming/', include('streaming.urls')),
]
```

## 5. accounts 앱

```python
#################################
# accounts/models.py

from django.db import models
from django.contrib.auth.models import AbstractUser

class User(AbstractUser):
    profile_image = models.ImageField(upload_to='profiles/', blank=True)
    bio = models.TextField(blank=True)
    is_instructor = models.BooleanField(default=False)

    def __str__(self):
        return self.username

#################################
# accounts/urls.py

from django.urls import path
from . import views

urlpatterns = [
    path('signup/', views.signup, name='signup'),
    path('login/', views.login_view, name='login'),
    path('logout/', views.logout_view, name='logout'),
]

#################################
# accounts/views.py

from django.shortcuts import render, redirect
from django.contrib.auth import login, logout, authenticate
from django.contrib.auth.forms import UserCreationForm, AuthenticationForm

def signup(request):
    if request.method == 'POST':
        form = UserCreationForm(request.POST)
        if form.is_valid():
            user = form.save()
            login(request, user)
            return redirect('home')
    else:
        form = UserCreationForm()
    return render(request, 'accounts/signup.html', {'form': form})

def login_view(request):
    if request.method == 'POST':
        form = AuthenticationForm(request, data=request.POST)
        if form.is_valid():
            user = form.get_user()
            login(request, user)
            return redirect('home')
    else:
        form = AuthenticationForm()
    return render(request, 'accounts/login.html', {'form': form})

def logout_view(request):
    logout(request)
    return redirect('home')

#################################
# accounts/templates/accounts/signup.html

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원가입 - 위니버시티</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
    <div class="bg-white p-8 rounded shadow-md w-full max-w-md">
        <h1 class="text-2xl font-bold mb-6 text-center">회원가입</h1>
        <form method="post">
            {% csrf_token %}
            {% for field in form %}
            <div class="mb-4">
                <label class="block text-gray-700 mb-2">{{ field.label }}</label>
                <input type="{{ field.field.widget.input_type }}" name="{{ field.name }}"
                       class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                {% for error in field.errors %}
                <p class="text-red-500 text-sm mt-1">{{ error }}</p>
                {% endfor %}
            </div>
            {% endfor %}
            <button type="submit" class="w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600">가입하기</button>
        </form>
        <p class="mt-4 text-center">이미 계정이 있으신가요? <a href="{% url 'login' %}" class="text-blue-500">로그인</a></p>
    </div>
</body>
</html>

#################################
# accounts/templates/accounts/login.html

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로그인 - 위니버시티</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
    <div class="bg-white p-8 rounded shadow-md w-full max-w-md">
        <h1 class="text-2xl font-bold mb-6 text-center">로그인</h1>
        <form method="post">
            {% csrf_token %}
            <div class="mb-4">
                <label class="block text-gray-700 mb-2">아이디</label>
                <input type="text" name="username" class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 mb-2">비밀번호</label>
                <input type="password" name="password" class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            {% if form.errors %}
            <p class="text-red-500 text-sm mb-4">아이디 또는 비밀번호가 올바르지 않습니다.</p>
            {% endif %}
            <button type="submit" class="w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600">로그인</button>
        </form>
        <p class="mt-4 text-center">계정이 없으신가요? <a href="{% url 'signup' %}" class="text-blue-500">회원가입</a></p>
    </div>
</body>
</html>
```

## 6. courses 앱

```python
#################################
# courses/models.py

from django.db import models
from accounts.models import User

class Category(models.Model):
    name = models.CharField(max_length=100, unique=True)
    slug = models.SlugField(unique=True)

    def __str__(self):
        return self.name

class Course(models.Model):
    title = models.CharField(max_length=200)
    description = models.TextField()
    thumbnail = models.ImageField(upload_to='thumbnails/', blank=True)
    instructor = models.ForeignKey(User, on_delete=models.CASCADE)
    category = models.ForeignKey(Category, on_delete=models.SET_NULL, null=True)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.title

class Enrollment(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    course = models.ForeignKey(Course, on_delete=models.CASCADE)
    enrolled_at = models.DateTimeField(auto_now_add=True)

    class Meta:
        unique_together = ['user', 'course']

#################################
# courses/urls.py

from django.urls import path
from . import views

urlpatterns = [
    path('', views.home, name='home'),
    path('courses/', views.course_list, name='course_list'),
    path('courses/<int:course_id>/', views.course_detail, name='course_detail'),
    path('courses/<int:course_id>/enroll/', views.course_enroll, name='course_enroll'),
]

#################################
# courses/views.py

from django.shortcuts import render, get_object_or_404, redirect
from django.contrib.auth.decorators import login_required
from .models import Course, Enrollment

def home(request):
    courses = Course.objects.all()[:6]
    return render(request, 'courses/home.html', {'courses': courses})

def course_list(request):
    courses = Course.objects.all().order_by('-created_at')
    return render(request, 'courses/course_list.html', {'courses': courses})

def course_detail(request, course_id):
    course = get_object_or_404(Course, id=course_id)
    is_enrolled = False
    if request.user.is_authenticated:
        is_enrolled = Enrollment.objects.filter(user=request.user, course=course).exists()
    return render(request, 'courses/course_detail.html', {'course': course, 'is_enrolled': is_enrolled})

@login_required
def course_enroll(request, course_id):
    course = get_object_or_404(Course, id=course_id)
    Enrollment.objects.get_or_create(user=request.user, course=course)
    return redirect('course_detail', course_id=course_id)

#################################
# courses/templates/courses/home.html

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>위니버시티</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <nav class="bg-white shadow">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <a href="{% url 'home' %}" class="text-xl font-bold">위니버시티</a>
            <div class="space-x-4">
                <a href="{% url 'course_list' %}" class="text-gray-600 hover:text-gray-900">강의</a>
                {% if user.is_authenticated %}
                <a href="{% url 'dashboard_home' %}" class="text-gray-600 hover:text-gray-900">대시보드</a>
                <a href="{% url 'logout' %}" class="text-gray-600 hover:text-gray-900">로그아웃</a>
                {% else %}
                <a href="{% url 'login' %}" class="text-gray-600 hover:text-gray-900">로그인</a>
                <a href="{% url 'signup' %}" class="bg-blue-500 text-white px-4 py-2 rounded">회원가입</a>
                {% endif %}
            </div>
        </div>
    </nav>
    <main class="max-w-6xl mx-auto px-4 py-8">
        <h2 class="text-2xl font-bold mb-6">강의 목록</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            {% for course in courses %}
            <a href="{% url 'course_detail' course.id %}" class="bg-white rounded shadow hover:shadow-lg transition">
                <div class="p-4">
                    <h3 class="font-bold text-lg">{{ course.title }}</h3>
                    <p class="text-gray-600 text-sm mt-2">{{ course.instructor.username }}</p>
                </div>
            </a>
            {% empty %}
            <p class="text-gray-500">등록된 강의가 없습니다.</p>
            {% endfor %}
        </div>
    </main>
</body>
</html>

#################################
# courses/templates/courses/course_list.html

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>강의 목록 - 위니버시티</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <nav class="bg-white shadow">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <a href="{% url 'home' %}" class="text-xl font-bold">위니버시티</a>
            <div class="space-x-4">
                <a href="{% url 'course_list' %}" class="text-gray-600 hover:text-gray-900">강의</a>
                {% if user.is_authenticated %}
                <a href="{% url 'dashboard_home' %}" class="text-gray-600 hover:text-gray-900">대시보드</a>
                <a href="{% url 'logout' %}" class="text-gray-600 hover:text-gray-900">로그아웃</a>
                {% else %}
                <a href="{% url 'login' %}" class="text-gray-600 hover:text-gray-900">로그인</a>
                {% endif %}
            </div>
        </div>
    </nav>
    <main class="max-w-6xl mx-auto px-4 py-8">
        <h1 class="text-2xl font-bold mb-6">전체 강의</h1>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            {% for course in courses %}
            <a href="{% url 'course_detail' course.id %}" class="bg-white rounded shadow hover:shadow-lg transition">
                <div class="p-4">
                    <h3 class="font-bold text-lg">{{ course.title }}</h3>
                    <p class="text-gray-600 text-sm mt-2">{{ course.instructor.username }}</p>
                </div>
            </a>
            {% empty %}
            <p class="text-gray-500">등록된 강의가 없습니다.</p>
            {% endfor %}
        </div>
    </main>
</body>
</html>

#################################
# courses/templates/courses/course_detail.html

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ course.title }} - 위니버시티</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <nav class="bg-white shadow">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <a href="{% url 'home' %}" class="text-xl font-bold">위니버시티</a>
            <div class="space-x-4">
                <a href="{% url 'course_list' %}" class="text-gray-600 hover:text-gray-900">강의</a>
                {% if user.is_authenticated %}
                <a href="{% url 'dashboard_home' %}" class="text-gray-600 hover:text-gray-900">대시보드</a>
                <a href="{% url 'logout' %}" class="text-gray-600 hover:text-gray-900">로그아웃</a>
                {% else %}
                <a href="{% url 'login' %}" class="text-gray-600 hover:text-gray-900">로그인</a>
                {% endif %}
            </div>
        </div>
    </nav>
    <main class="max-w-6xl mx-auto px-4 py-8">
        <div class="bg-white rounded shadow p-6">
            <h1 class="text-3xl font-bold mb-4">{{ course.title }}</h1>
            <p class="text-gray-600 mb-4">강사: {{ course.instructor.username }}</p>
            <p class="text-gray-700 mb-6">{{ course.description }}</p>
            {% if is_enrolled %}
            <a href="{% url 'lesson_list' course.id %}" class="bg-green-500 text-white px-6 py-2 rounded hover:bg-green-600">강의 보기</a>
            {% else %}
            <form method="post" action="{% url 'course_enroll' course.id %}">
                {% csrf_token %}
                <button type="submit" class="bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600">수강 신청</button>
            </form>
            {% endif %}
        </div>
    </main>
</body>
</html>

#################################
# courses/admin.py

from django.contrib import admin
from .models import Category, Course, Enrollment

admin.site.register(Category)
admin.site.register(Course)
admin.site.register(Enrollment)
```

## 7. dashboard 앱

```python
#################################
# dashboard/urls.py

from django.urls import path
from . import views

urlpatterns = [
    path('', views.dashboard_home, name='dashboard_home'),
    path('my-courses/', views.my_courses, name='my_courses'),
]

#################################
# dashboard/views.py

from django.shortcuts import render
from django.contrib.auth.decorators import login_required
from courses.models import Enrollment

@login_required
def dashboard_home(request):
    enrollments = Enrollment.objects.filter(user=request.user)[:5]
    return render(request, 'dashboard/dashboard_home.html', {'enrollments': enrollments})

@login_required
def my_courses(request):
    enrollments = Enrollment.objects.filter(user=request.user)
    return render(request, 'dashboard/my_courses.html', {'enrollments': enrollments})

#################################
# dashboard/templates/dashboard/dashboard_home.html

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>대시보드 - 위니버시티</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <nav class="bg-white shadow">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <a href="{% url 'home' %}" class="text-xl font-bold">위니버시티</a>
            <div class="space-x-4">
                <a href="{% url 'course_list' %}" class="text-gray-600 hover:text-gray-900">강의</a>
                <a href="{% url 'dashboard_home' %}" class="text-gray-600 hover:text-gray-900">대시보드</a>
                <a href="{% url 'logout' %}" class="text-gray-600 hover:text-gray-900">로그아웃</a>
            </div>
        </div>
    </nav>
    <main class="max-w-6xl mx-auto px-4 py-8">
        <h1 class="text-2xl font-bold mb-6">대시보드</h1>
        <div class="bg-white rounded shadow p-6 mb-6">
            <h2 class="text-xl font-bold mb-4">안녕하세요, {{ user.username }}님!</h2>
            <a href="{% url 'my_courses' %}" class="text-blue-500 hover:underline">내 수강 강의 보기</a>
        </div>
        <div class="bg-white rounded shadow p-6">
            <h2 class="text-xl font-bold mb-4">최근 수강 강의</h2>
            {% for enrollment in enrollments %}
            <div class="border-b py-2">
                <a href="{% url 'lesson_list' enrollment.course.id %}" class="text-blue-500 hover:underline">{{ enrollment.course.title }}</a>
            </div>
            {% empty %}
            <p class="text-gray-500">수강 중인 강의가 없습니다.</p>
            {% endfor %}
        </div>
    </main>
</body>
</html>

#################################
# dashboard/templates/dashboard/my_courses.html

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>내 강의 - 위니버시티</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <nav class="bg-white shadow">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <a href="{% url 'home' %}" class="text-xl font-bold">위니버시티</a>
            <div class="space-x-4">
                <a href="{% url 'course_list' %}" class="text-gray-600 hover:text-gray-900">강의</a>
                <a href="{% url 'dashboard_home' %}" class="text-gray-600 hover:text-gray-900">대시보드</a>
                <a href="{% url 'logout' %}" class="text-gray-600 hover:text-gray-900">로그아웃</a>
            </div>
        </div>
    </nav>
    <main class="max-w-6xl mx-auto px-4 py-8">
        <h1 class="text-2xl font-bold mb-6">내 수강 강의</h1>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            {% for enrollment in enrollments %}
            <a href="{% url 'lesson_list' enrollment.course.id %}" class="bg-white rounded shadow hover:shadow-lg transition p-4">
                <h3 class="font-bold text-lg">{{ enrollment.course.title }}</h3>
                <p class="text-gray-600 text-sm mt-2">수강 시작: {{ enrollment.enrolled_at|date:"Y.m.d" }}</p>
            </a>
            {% empty %}
            <p class="text-gray-500">수강 중인 강의가 없습니다. <a href="{% url 'course_list' %}" class="text-blue-500">강의 둘러보기</a></p>
            {% endfor %}
        </div>
    </main>
</body>
</html>
```

## 8. streaming 앱

```python
#################################
# streaming/models.py

from django.db import models
from courses.models import Course

class Lesson(models.Model):
    course = models.ForeignKey(Course, on_delete=models.CASCADE, related_name='lessons')
    title = models.CharField(max_length=200)
    video_url = models.URLField()
    order = models.PositiveIntegerField()

    class Meta:
        unique_together = ['course', 'order']
        ordering = ['order']

    def __str__(self):
        return f"{self.course.title} - {self.title}"

#################################
# streaming/urls.py

from django.urls import path
from . import views

urlpatterns = [
    path('<int:course_id>/lessons/', views.lesson_list, name='lesson_list'),
    path('<int:course_id>/lessons/<int:lesson_id>/', views.lesson_detail, name='lesson_detail'),
]

#################################
# streaming/views.py

from django.shortcuts import render, get_object_or_404
from django.contrib.auth.decorators import login_required
from courses.models import Course, Enrollment
from .models import Lesson

@login_required
def lesson_list(request, course_id):
    course = get_object_or_404(Course, id=course_id)
    if not Enrollment.objects.filter(user=request.user, course=course).exists():
        return redirect('course_detail', course_id=course_id)
    lessons = Lesson.objects.filter(course=course)
    return render(request, 'streaming/lesson_list.html', {'course': course, 'lessons': lessons})

@login_required
def lesson_detail(request, course_id, lesson_id):
    course = get_object_or_404(Course, id=course_id)
    if not Enrollment.objects.filter(user=request.user, course=course).exists():
        return redirect('course_detail', course_id=course_id)
    lesson = get_object_or_404(Lesson, id=lesson_id, course=course)
    lessons = Lesson.objects.filter(course=course)
    return render(request, 'streaming/lesson_detail.html', {'course': course, 'lesson': lesson, 'lessons': lessons})

#################################
# streaming/templates/streaming/lesson_list.html

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ course.title }} - 위니버시티</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <nav class="bg-white shadow">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <a href="{% url 'home' %}" class="text-xl font-bold">위니버시티</a>
            <div class="space-x-4">
                <a href="{% url 'course_list' %}" class="text-gray-600 hover:text-gray-900">강의</a>
                <a href="{% url 'dashboard_home' %}" class="text-gray-600 hover:text-gray-900">대시보드</a>
                <a href="{% url 'logout' %}" class="text-gray-600 hover:text-gray-900">로그아웃</a>
            </div>
        </div>
    </nav>
    <main class="max-w-6xl mx-auto px-4 py-8">
        <h1 class="text-2xl font-bold mb-6">{{ course.title }}</h1>
        <div class="bg-white rounded shadow">
            {% for lesson in lessons %}
            <a href="{% url 'lesson_detail' course.id lesson.id %}" class="block border-b p-4 hover:bg-gray-50">
                <span class="text-gray-500 mr-2">{{ lesson.order }}.</span>
                {{ lesson.title }}
            </a>
            {% empty %}
            <p class="p-4 text-gray-500">등록된 레슨이 없습니다.</p>
            {% endfor %}
        </div>
    </main>
</body>
</html>

#################################
# streaming/templates/streaming/lesson_detail.html

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ lesson.title }} - 위니버시티</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <nav class="bg-white shadow">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <a href="{% url 'home' %}" class="text-xl font-bold">위니버시티</a>
            <div class="space-x-4">
                <a href="{% url 'course_list' %}" class="text-gray-600 hover:text-gray-900">강의</a>
                <a href="{% url 'dashboard_home' %}" class="text-gray-600 hover:text-gray-900">대시보드</a>
                <a href="{% url 'logout' %}" class="text-gray-600 hover:text-gray-900">로그아웃</a>
            </div>
        </div>
    </nav>
    <main class="max-w-6xl mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <div class="lg:col-span-3">
                <div class="bg-black aspect-video mb-4">
                    <iframe src="{{ lesson.video_url }}" class="w-full h-full" allowfullscreen></iframe>
                </div>
                <div class="bg-white rounded shadow p-4">
                    <h1 class="text-xl font-bold">{{ lesson.title }}</h1>
                </div>
            </div>
            <div class="bg-white rounded shadow">
                <h2 class="font-bold p-4 border-b">커리큘럼</h2>
                {% for l in lessons %}
                <a href="{% url 'lesson_detail' course.id l.id %}"
                   class="block border-b p-3 text-sm hover:bg-gray-50 {% if l.id == lesson.id %}bg-blue-50{% endif %}">
                    <span class="text-gray-500 mr-2">{{ l.order }}.</span>
                    {{ l.title }}
                </a>
                {% endfor %}
            </div>
        </div>
    </main>
</body>
</html>

#################################
# streaming/admin.py

from django.contrib import admin
from .models import Lesson

admin.site.register(Lesson)
```

## 9. 마이그레이션 및 관리자 생성

```bash
# terminal commands
python manage.py makemigrations
python manage.py migrate
python manage.py createsuperuser
# 관리자 정보 입력 후
python manage.py runserver
```

만약 위 migrate에서 오류가 발생하면, db.sliqte3 파일을 삭제하고, 각 앱의 migrations 폴더 내의 `__init__.py`를 제외한 모든 파일을 삭제한 후 다시 시도합니다.

시도 할 때에는 아래 순서로 하시면 됩니다.

```
python manage.py makemigrations accounts
python manage.py makemigrations courses
python manage.py makemigrations dashboard
python manage.py makemigrations streaming

python manage.py migrate accounts
python manage.py migrate courses
python manage.py migrate dashboard
python manage.py migrate streaming
```

## 10. 테스트용 데이터 추가

관리자 페이지(http://127.0.0.1:8000/admin/)에서:
1. Category 추가 (예: Python, JavaScript)
2. Course 추가 (강의 제목, 설명, 강사 선택)
3. Lesson 추가 (강의 선택, 레슨 제목, 영상 파일 업로드, 순서)

## 11. 동영상 파일 업로드 기능

기존 URL 방식에서 파일 업로드 방식으로 변경합니다.

### 11.1 settings.py 미디어 설정 추가

```python
#################################
# config/settings.py

# 파일 끝에 추가
MEDIA_URL = '/media/'
MEDIA_ROOT = BASE_DIR / 'media'
```

### 11.2 config/urls.py 미디어 URL 설정

```python
#################################
# config/urls.py

from django.contrib import admin
from django.urls import path, include
from django.conf import settings
from django.conf.urls.static import static

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('courses.urls')),
    path('accounts/', include('accounts.urls')),
    path('dashboard/', include('dashboard.urls')),
    path('streaming/', include('streaming.urls')),
]

if settings.DEBUG:
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
```

### 11.3 Lesson 모델 수정

```python
#################################
# streaming/models.py

from django.db import models
from courses.models import Course

class Lesson(models.Model):
    course = models.ForeignKey(Course, on_delete=models.CASCADE, related_name='lessons')
    title = models.CharField(max_length=200)
    video_file = models.FileField(upload_to='lessons/videos/')
    order = models.PositiveIntegerField()

    class Meta:
        unique_together = ['course', 'order']
        ordering = ['order']

    def __str__(self):
        return f"{self.course.title} - {self.title}"
```

### 11.4 lesson_detail.html 템플릿 수정

```html
#################################
# streaming/templates/streaming/lesson_detail.html

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ lesson.title }} - 위니버시티</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <nav class="bg-white shadow">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <a href="{% url 'home' %}" class="text-xl font-bold">위니버시티</a>
            <div class="space-x-4">
                <a href="{% url 'course_list' %}" class="text-gray-600 hover:text-gray-900">강의</a>
                <a href="{% url 'dashboard_home' %}" class="text-gray-600 hover:text-gray-900">대시보드</a>
                <a href="{% url 'logout' %}" class="text-gray-600 hover:text-gray-900">로그아웃</a>
            </div>
        </div>
    </nav>
    <main class="max-w-6xl mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <div class="lg:col-span-3">
                <div class="bg-black aspect-video mb-4">
                    <video controls class="w-full h-full">
                        <source src="{{ lesson.video_file.url }}" type="video/mp4">
                        브라우저가 비디오 태그를 지원하지 않습니다.
                    </video>
                </div>
                <div class="bg-white rounded shadow p-4">
                    <h1 class="text-xl font-bold">{{ lesson.title }}</h1>
                </div>
            </div>
            <div class="bg-white rounded shadow">
                <h2 class="font-bold p-4 border-b">커리큘럼</h2>
                {% for l in lessons %}
                <a href="{% url 'lesson_detail' course.id l.id %}"
                   class="block border-b p-3 text-sm hover:bg-gray-50 {% if l.id == lesson.id %}bg-blue-50{% endif %}">
                    <span class="text-gray-500 mr-2">{{ l.order }}.</span>
                    {{ l.title }}
                </a>
                {% endfor %}
            </div>
        </div>
    </main>
</body>
</html>
```

### 11.5 마이그레이션 실행

```bash
# terminal commands
python manage.py makemigrations streaming
python manage.py migrate streaming
```

만약 기존 데이터가 있어서 오류가 발생하면, db.sqlite3 파일을 삭제하고 전체 마이그레이션을 다시 실행합니다.

```bash
# 기존 데이터 삭제 후 재마이그레이션
python manage.py makemigrations
python manage.py migrate
python manage.py createsuperuser
```

## 12. 내 프로필 수정 기능

### 12.1 URL 추가

```python
#################################
# accounts/urls.py

from django.urls import path
from . import views

urlpatterns = [
    path('signup/', views.signup, name='signup'),
    path('login/', views.login_view, name='login'),
    path('logout/', views.logout_view, name='logout'),
    path('profile/', views.profile, name='profile'),
    path('profile/edit/', views.profile_edit, name='profile_edit'),
]
```

### 12.2 forms.py 생성

```python
#################################
# accounts/forms.py

from django import forms
from .models import User

class ProfileEditForm(forms.ModelForm):
    class Meta:
        model = User
        fields = ['username', 'email', 'profile_image', 'bio']
        widgets = {
            'bio': forms.Textarea(attrs={'rows': 4}),
        }
```

### 12.3 views.py에 프로필 뷰 추가

```python
#################################
# accounts/views.py

from django.shortcuts import render, redirect
from django.contrib.auth import login, logout, authenticate
from django.contrib.auth.forms import UserCreationForm, AuthenticationForm
from django.contrib.auth.decorators import login_required
from .forms import ProfileEditForm

def signup(request):
    if request.method == 'POST':
        form = UserCreationForm(request.POST)
        if form.is_valid():
            user = form.save()
            login(request, user)
            return redirect('home')
    else:
        form = UserCreationForm()
    return render(request, 'accounts/signup.html', {'form': form})

def login_view(request):
    if request.method == 'POST':
        form = AuthenticationForm(request, data=request.POST)
        if form.is_valid():
            user = form.get_user()
            login(request, user)
            return redirect('home')
    else:
        form = AuthenticationForm()
    return render(request, 'accounts/login.html', {'form': form})

def logout_view(request):
    logout(request)
    return redirect('home')

@login_required
def profile(request):
    return render(request, 'accounts/profile.html')

@login_required
def profile_edit(request):
    if request.method == 'POST':
        form = ProfileEditForm(request.POST, request.FILES, instance=request.user)
        if form.is_valid():
            form.save()
            return redirect('profile')
    else:
        form = ProfileEditForm(instance=request.user)
    return render(request, 'accounts/profile_edit.html', {'form': form})
```

### 12.4 프로필 페이지 템플릿

```html
#################################
# accounts/templates/accounts/profile.html

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>내 프로필 - 위니버시티</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <nav class="bg-white shadow">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <a href="{% url 'home' %}" class="text-xl font-bold">위니버시티</a>
            <div class="space-x-4">
                <a href="{% url 'course_list' %}" class="text-gray-600 hover:text-gray-900">강의</a>
                <a href="{% url 'dashboard_home' %}" class="text-gray-600 hover:text-gray-900">대시보드</a>
                <a href="{% url 'logout' %}" class="text-gray-600 hover:text-gray-900">로그아웃</a>
            </div>
        </div>
    </nav>
    <main class="max-w-6xl mx-auto px-4 py-8">
        <div class="bg-white rounded shadow p-6">
            <div class="flex items-center mb-6">
                {% if user.profile_image %}
                <img src="{{ user.profile_image.url }}" alt="프로필" class="w-24 h-24 rounded-full object-cover mr-6">
                {% else %}
                <div class="w-24 h-24 rounded-full bg-gray-300 flex items-center justify-center mr-6">
                    <span class="text-3xl text-gray-600">{{ user.username|first|upper }}</span>
                </div>
                {% endif %}
                <div>
                    <h1 class="text-2xl font-bold">{{ user.username }}</h1>
                    <p class="text-gray-600">{{ user.email }}</p>
                    {% if user.is_instructor %}
                    <span class="inline-block mt-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">강사</span>
                    {% endif %}
                </div>
            </div>
            {% if user.bio %}
            <div class="mb-6">
                <h2 class="text-lg font-bold mb-2">소개</h2>
                <p class="text-gray-700">{{ user.bio }}</p>
            </div>
            {% endif %}
            <a href="{% url 'profile_edit' %}" class="inline-block bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600">프로필 수정</a>
        </div>
    </main>
</body>
</html>
```

### 12.5 프로필 수정 페이지 템플릿

```html
#################################
# accounts/templates/accounts/profile_edit.html

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>프로필 수정 - 위니버시티</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <nav class="bg-white shadow">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <a href="{% url 'home' %}" class="text-xl font-bold">위니버시티</a>
            <div class="space-x-4">
                <a href="{% url 'course_list' %}" class="text-gray-600 hover:text-gray-900">강의</a>
                <a href="{% url 'dashboard_home' %}" class="text-gray-600 hover:text-gray-900">대시보드</a>
                <a href="{% url 'logout' %}" class="text-gray-600 hover:text-gray-900">로그아웃</a>
            </div>
        </div>
    </nav>
    <main class="max-w-6xl mx-auto px-4 py-8">
        <div class="bg-white rounded shadow p-6 max-w-2xl mx-auto">
            <h1 class="text-2xl font-bold mb-6">프로필 수정</h1>
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">사용자명</label>
                    <input type="text" name="username" value="{{ form.username.value }}"
                           class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                    {% for error in form.username.errors %}
                    <p class="text-red-500 text-sm mt-1">{{ error }}</p>
                    {% endfor %}
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">이메일</label>
                    <input type="email" name="email" value="{{ form.email.value|default:'' }}"
                           class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                    {% for error in form.email.errors %}
                    <p class="text-red-500 text-sm mt-1">{{ error }}</p>
                    {% endfor %}
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">프로필 이미지</label>
                    {% if user.profile_image %}
                    <div class="mb-2">
                        <img src="{{ user.profile_image.url }}" alt="현재 프로필" class="w-20 h-20 rounded-full object-cover">
                    </div>
                    {% endif %}
                    <input type="file" name="profile_image" accept="image/*"
                           class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 mb-2">자기소개</label>
                    <textarea name="bio" rows="4"
                              class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500">{{ form.bio.value|default:'' }}</textarea>
                </div>
                <div class="flex space-x-4">
                    <button type="submit" class="bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600">저장</button>
                    <a href="{% url 'profile' %}" class="bg-gray-300 text-gray-700 px-6 py-2 rounded hover:bg-gray-400">취소</a>
                </div>
            </form>
        </div>
    </main>
</body>
</html>
```

### 12.6 네비게이션에 프로필 링크 추가

대시보드 및 다른 페이지의 네비게이션에 프로필 링크를 추가합니다.

```html
#################################
# 네비게이션 수정 예시 (각 템플릿의 nav 부분)

<nav class="bg-white shadow">
    <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
        <a href="{% url 'home' %}" class="text-xl font-bold">위니버시티</a>
        <div class="space-x-4">
            <a href="{% url 'course_list' %}" class="text-gray-600 hover:text-gray-900">강의</a>
            {% if user.is_authenticated %}
            <a href="{% url 'dashboard_home' %}" class="text-gray-600 hover:text-gray-900">대시보드</a>
            <a href="{% url 'profile' %}" class="text-gray-600 hover:text-gray-900">내 프로필</a>
            <a href="{% url 'logout' %}" class="text-gray-600 hover:text-gray-900">로그아웃</a>
            {% else %}
            <a href="{% url 'login' %}" class="text-gray-600 hover:text-gray-900">로그인</a>
            <a href="{% url 'signup' %}" class="bg-blue-500 text-white px-4 py-2 rounded">회원가입</a>
            {% endif %}
        </div>
    </div>
</nav>
```

### 12.7 URL 설계 업데이트

```
'/accounts/profile/': 내 프로필 페이지
'/accounts/profile/edit/': 프로필 수정 페이지
```
